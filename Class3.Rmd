# Student ID: 101402  
# Name: UBANJE Albert
---
title: "R for Data Science – Class 3: Control Structures, Functions & Aggregation"
author: "UBANJE Albert"
output: html_document
---

```{r}
#1. Control Structures in R

#Control structures allow conditional or repetitive execution of R expressions.

#If and Else
x <- runif(1, 0, 10)  # random number between 0 and 10

if (x > 3) {
y <- 10
} else {
y <- 0
}

cat("x =", x, "→ y =", y, "\n")

# Same logic in one line

y <- if (x > 3) 10 else 0
y

#Ifelse Function
pvalues <- c(.867, 0.0054, 0.0018, 0.1572, 0.0183, 0.5386)
results <- ifelse(pvalues < 0.05, "Significant", "Not significant")
results

#For Loops
for (i in 1:10) {
print(i)
}

x <- c("a", "b", "c", "d")
for (i in 1:5) print(x[i])
for (i in 1:5) print(1:i)
for (i in 5:1) print(1:i)

#While Loop
count <- 1
while (count < 10) {
print(count)
count <- count + 1
}
#Example with random movement
z <- 5
set.seed(1)
while (z >= 3 && z <= 10) {
coin <- rbinom(1, 1, 0.5)
if (coin == 1) {
z <- z + 1
} else {
z <- z - 1
}
}
z
#Break and Next
for (i in 1:100) {
print(1:i)
if (i > 20) {
break
}
}
# 2. Creating Functions in R
# Basic Functions
f <- function(x, y) {
result <- x + (2 * y) + 3
return(result)
}

f(2, 3)

#View a function’s structure:
formals(f)
body(f)
environment(f)

#Practice: Write your own functions
# Square + 2

f1 <- function(x) {
result <- x^2 + 2
return(result)
}

# Example: calculate two-sample t-test manually

t_test_func <- function(x1, x2) {
t.test(x1, x2)
}
#3. Applying Functions to Matrices and Data Frames
a <- 4
sqrt(a)

b <- c(1, 243, 5.754, 2.987)
round(b)

c <- matrix(runif(12), nrow = 3)
c
log(c)
mean(c)

# Apply mean by rows/columns

apply(c, 1, mean)
apply(c, 2, mean)

#4. lapply, sapply and Variants
fix_missing <- function(x) {
x[x == -99] <- NA
x
}

function1 <- function(x) {
x^2
}

curve(function1, -4, 4)

#5. Titanic Data Example
str(Titanic)
apply(Titanic, c(1,2), sum)
apply(Titanic, c(1,4), sum)[3:4,]
ftable(apply(Titanic, c(1,4,2), sum)[3:4,,])


#Compute Proportions
prop.table(ftable(apply(Titanic, c(1,4,2), sum)[3:4,,])[1:2,], margin=2)
prop.table(ftable(apply(Titanic, c(1,4,2), sum)[3:4,,])[3:4,], margin=2)

#6. Creating and Managing a Student Dataset
Student <- c("John Ncuti", "Angela Bakame", "Bruce Wizeye", "Alexis Aganze",
"Claude Rukundo", "Joel Kagabo", "Mary Ineza")
Math <- c(600, 412, 358, 495, 512, 410, 522)
Science <- c(95, 99, 80, 82, 75, 89, 77)
English <- c(25, 22, 18, 20, 29, 30, 27)
roster <- data.frame(Student, Math, Science, English, stringsAsFactors = FALSE)

# Standardize & compute performance

z <- scale(roster[, 2:4])
score <- apply(z, 1, mean)
roster <- cbind(roster, score)

# Assign grades using quantiles

y <- quantile(score, c(.8, .6, .4, .2))
roster$grade[score >= y[1]] <- "A"
roster$grade[score < y[1] & score >= y[2]] <- "B"
roster$grade[score < y[2] & score >= y[3]] <- "C"
roster$grade[score < y[3] & score >= y[4]] <- "D"
roster$grade[score < y[4]] <- "F"

# Sort by student name

name <- strsplit(roster$Student, " ")
lastname <- sapply(name, function(x) tail(x, 1))
firstname <- sapply(name, function(x) head(x, 1))
roster <- cbind(firstname, lastname, roster[, -1])
roster <- roster[order(lastname, firstname), ]
roster

#7. Aggregation and Reshaping
#Transpose
cars <- mtcars[1:5, 1:4]
t(cars)

#Aggregate Data
options(digits = 3)
attach(mtcars)
aggdata <- aggregate(mtcars, by = list(cyl, gear), FUN = mean, na.rm = TRUE)
head(aggdata)
detach(mtcars)

#Reshape Data# 
#install.packages("reshape2")

library(reshape2)

id <- c(1, 1, 2, 2)
time <- c(1, 2, 1, 2)
x1 <- c(5, 3, 6, 2)
x2 <- c(6, 5, 1, 4)
mydata <- data.frame(id, time, x1, x2)
mymelt <- melt(mydata, id = c("id", "time"))
mycast <- dcast(mymelt, id ~ variable, mean)
mycast

